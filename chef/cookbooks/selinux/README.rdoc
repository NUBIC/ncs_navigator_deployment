= DESCRIPTION:

Provides a recipe and LWRPs for managing SELinux policy.

Specifically:

* The `selinux::management` recipe installs packages necessary for SELinux policy management.
* The `selinux_security_context` LWRP manipulates security contexts on files.
* The `selinux_policy` LWRP can be used to write, install, and delete SELinux policy modules.

= REQUIREMENTS:

A system running SELinux in enforcing or permissive mode.

= ATTRIBUTES:

* `node[:selinux][:makefile]`: Path to the Makefile used for compiling policy
  modules.  Defaults to `/usr/share/selinux/devel/Makefile`.

= USAGE:

The LWRPs are meant to be used from other cookbooks.  Example usage:

== Restore a default security context

    selinux_security_context "/some/path" do
      action :restore
    end

== Install a new policy module

    selinux_policy "apache_to_sample_apps" do
      version "1.0.0"
      action :create
      policy <<-END
      gen_require(`
        type httpd_t;
      ')

      type sample_port_t;

      allow httpd_t sample_port_t:tcp_socket name_connect;
      END
    end

The selinux_policy LWRP will generate the `policy_module` header from the policy
name and version, and will install or upgrade a policy based on whether or not
the policy has already been installed.

== Install a policy module from a file

For longer SELinux policies, it may be convenient to write the policies in
separate files.  The selinux_policy LWRP supports this:

    selinux_policy "apache_to_sample_apps" do
      version "1.0.0"
      action :create
      policy_file "apache_to_sample_apps.te"
    end

The location of the policy file will be determined using the same file
specificity rules used in Chef's Cookbook File resource.

As in the above inline case, the LWRP will generate the `policy_module` header
from the policy name and version.

== Remove a policy module

    selinux_policy "apache_to_sample_apps" do
      action :delete
    end

The selinux_policy LWRP does not check for dependencies, so attempts to delete
policy modules that have e.g. types in use will result in an error.
